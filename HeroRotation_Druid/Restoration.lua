local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Pet;local i=f.Target;local j=d.Spell;local k=d.MultiSpell;local l=d.Item;local m=HeroRotation;local n=m.AoEON;local o=m.CDsON;local p=m.Cast;local q=f.Focus;local r=f.MouseOver;local s,t;local u,v;local w,x;local y,z,A,B,C;local D=11111;local E=11111;local F;local G,H;local I,J;local K=math.floor;local L=m.Commons.Everyone;local M=m.Commons.Everyone.num;local N={General=m.GUISettings.General,Commons=m.GUISettings.APL.Druid.Commons,Restoration=m.GUISettings.APL.Druid.Restoration,Utilities=m.GUISettings.Utilities}local O={not HeroRotationCharDB.Toggles[15],HeroRotationCharDB.Toggles[5],HeroRotationCharDB.Toggles[4],N.Restoration.AVGHeal,N.Restoration.UseBarkskin,N.Restoration.BarkskinHP,N.Restoration.UseRenewal,N.Restoration.RenewalHP,N.Restoration.IronbarkHP,N.Restoration.UseIronbark,N.Restoration.UseAdaptiveSwarmForHeal,N.Restoration.UseAdaptiveSwarmForDPS,N.Restoration.UseLifebloomTank,N.Restoration.LifebloomTankHP,N.Restoration.UseLifebloom,N.Restoration.LifebloomHP,N.Restoration.UseConvokeTheSpiritsForHeal,N.Restoration.ConvokeTheSpiritsGroup,N.Restoration.ConvokeTheSpiritsHP,N.Restoration.UseNaturesSwiftness,N.Restoration.NaturesSwiftnessHP,N.Restoration.UseGroveGuardians,N.Restoration.GroveGuardiansHP,N.Restoration.GroveGuardiansGroup,N.Restoration.FlourishHP,N.Restoration.FlourishGroup,N.Restoration.TranquilityHP,N.Restoration.TranquilityGroup,N.Restoration.TranquilityTreeHP,N.Restoration.TranquilityTreeGroup,N.Restoration.UseWildgrowth,N.Restoration.WildgrowthHP,N.Restoration.WildgrowthGroup,N.Restoration.UseRegrowth,N.Restoration.RegrowthHP,N.Restoration.UseRejuvenation,N.Restoration.RejuvenationHP,N.Restoration.RegrowthRefreshHP,N.Restoration.UseRegrowthRefresh,N.Restoration.UseCenarionWard,N.Restoration.CenarionWardHP}local P=N.Utilities.UseHealPotion;local Q=N.Utilities.UseManaPotion;local R=N.Utilities.UseHealthstone;local S=N.Utilities.UseDpsPotion;local T=N.Utilities.HealPotionHP;local U=N.Utilities.ManaPotionHP;local V=N.Utilities.HealthstoneHP;local W=j.Druid.Restoration;local X=l.Druid.Restoration;local Y={}local Z,_;local D=11111;local E=11111;local a0=false;local a1=false;local a2=false;local a3=false;local a4=false;local a5=false;local a6=false;d:RegisterForEvent(function()D=11111;E=11111 end,"PLAYER_REGEN_ENABLED")local function a7()return g:StealthUp(true,true)and 1.6 or 1 end;W.Rake:RegisterPMultiplier(W.RakeDebuff,a7)local function a8(a9)return a9:DebuffStack(W.AdaptiveSwarmDebuff)end;local function aa(a9)return a9:DebuffRemains(W.AdaptiveSwarmDebuff)>2 end;local function ab(a9)return a9:DebuffStack(W.AdaptiveSwarmDebuff)==1 and a9:DebuffRemains(W.AdaptiveSwarmDebuff)>2 end;local function ac(a9)return a9:DebuffStack(W.AdaptiveSwarmDebuff)==2 and a9:DebuffRemains(W.AdaptiveSwarmDebuff)>2 end;local function ad(a9)return a9:DebuffStack(W.AdaptiveSwarmDebuff)==3 and a9:DebuffRemains(W.AdaptiveSwarmDebuff)>2 end;local function ae(a9)return a9:DebuffStack(W.AdaptiveSwarmDebuff)==4 and a9:DebuffRemains(W.AdaptiveSwarmDebuff)>2 end;local function af(a9)return a9:DebuffStack(W.AdaptiveSwarmDebuff)==0 end;local function ag(a9)return a9:DebuffRefreshable(W.SunfireDebuff)and E>5 end;local function ah()a0=g:BuffUp(W.EclipseSolar)or g:BuffUp(W.EclipseLunar)a1=g:BuffUp(W.EclipseSolar)and g:BuffUp(W.EclipseLunar)a2=g:BuffUp(W.EclipseLunar)and g:BuffDown(W.EclipseSolar)a3=g:BuffUp(W.EclipseSolar)and g:BuffDown(W.EclipseLunar)a4=not a0 and(W.Starfire:Count()==0 and W.Wrath:Count()>0 or g:IsCasting(W.Wrath))or a3;a5=not a0 and(W.Wrath:Count()==0 and W.Starfire:Count()>0 or g:IsCasting(W.Starfire))or a2;a6=not a0 and W.Wrath:Count()>0 and W.Starfire:Count()>0 end;local function ai(a9)return a9:DebuffRefreshable(W.MoonfireDebuff)and E>12 and((_<=4+16 or g:Energy()<50)and g:BuffDown(W.HeartoftheWildBuff)or(_<=4 or g:Energy()<50)and g:BuffUp(W.HeartoftheWildBuff))and a9:DebuffDown(W.MoonfireDebuff)or g:PrevGCD(1,W.Sunfire)and(a9:DebuffUp(W.MoonfireDebuff)and a9:DebuffRemains(W.MoonfireDebuff)<a9:DebuffDuration(W.MoonfireDebuff)*0.8 or a9:DebuffDown(W.MoonfireDebuff))and _==1 end;local function aj(a9)return(a9:DebuffRefreshable(W.RipDebuff)or g:Energy()>90 and a9:DebuffRemains(W.RipDebuff)<=10)and(g:ComboPoints()==5 and a9:TimeToDie()>a9:DebuffRemains(W.RipDebuff)+24 or a9:DebuffRemains(W.RipDebuff)+g:ComboPoints()*4<a9:TimeToDie()and a9:DebuffRemains(W.RipDebuff)+4+g:ComboPoints()*4>a9:TimeToDie())or a9:DebuffDown(W.RipDebuff)and g:ComboPoints()>2+_*2 end;local function ak(a9)return g:PMultiplier(W.Rake)>a9:PMultiplier(W.Rake)end;local function al(a9)return(a9:DebuffDown(W.AdaptiveSwarmDebuff)or a9:DebuffRemains(W.AdaptiveSwarmDebuff)<2)and a9:DebuffStack(W.AdaptiveSwarmDebuff)<3 and not W.AdaptiveSwarm:InFlight()and a9:TimeToDie()>5 end;local function am(a9)return a9:DebuffRefreshable(W.MoonfireDebuff)and a9:TimeToDie()>5 end;local function an()return L.FriendlyUnitsWithBuffCount(W.Rejuvenation)+L.FriendlyUnitsWithBuffCount(W.Regrowth)+L.FriendlyUnitsWithBuffCount(W.Wildgrowth)end;local function ao(a9)return a9:BuffUp(W.Rejuvenation)or a9:BuffUp(W.Regrowth)or a9:BuffUp(W.Wildgrowth)end;local function ap(a9)return a9:BuffUp(W.Rejuvenation)end;local function aq()return L.FriendlyUnitsWithoutBuffCount(W.Rejuvenation)end;local function ar()return L.FriendlyUnitsWithoutBuffCount(W.Rejuvenation)end;local function as(a9)return a9:DebuffRefreshable(W.SunfireDebuff)end;local function at(a9)return a9:DebuffRefreshable(W.MoonfireDebuff)end;local function au(a9)local av=a9:DebuffRemains(W.MoonfireDebuff)return a9:DebuffRefreshable(W.MoonfireDebuff)and av<2 and a9:TimeToDie()-av>6 end;local function aw(a9)local av=a9:DebuffRemains(W.SunfireDebuff)return a9:DebuffRefreshable(W.SunfireDebuff)and av<2 and a9:TimeToDie()-av>6 end;local function ax()if W.MoonkinForm:IsAvailable()then if W.CatForm:IsReady()and not g:BuffUp(W.CatForm)then if p(W.CatForm)then m.ReturnShouldcast=768;return"cat_form precombat 2"end end;if W.Prowl:IsReady()and not g:BuffUp(W.Prowl)then if p(W.Prowl)then m.ReturnShouldcast=5215;return"prowl precombat 4"end end end;if W.MoonkinForm:IsReady()and W.BalanceAffinity:IsAvailable()then if p(W.MoonkinForm)then m.ReturnShouldcast=197625;return"moonkin_form precombat 6"end end;if W.Shred:IsReady()and W.FeralAffinity:IsAvailable()then if p(W.Shred,nil,nil,not i:IsSpellInRange(W.Shred))then m.ReturnShouldcast=5221;return"shred precombat 8"end end;if not W.MoonkinForm:IsAvailable()then if W.Moonfire:IsReady()then if p(W.Moonfire,nil,nil,not i:IsSpellInRange(W.Moonfire))then m.ReturnShouldcast=8921;return"moonfire precombat 10"end end;if W.Sunfire:IsReady()then if p(W.Sunfire,nil,nil,not i:IsSpellInRange(W.Sunfire))then m.ReturnShouldcast=93402;return"sunfire precombat 12"end end end end;local function ay()if W.Rake:IsReady()and(not g:StealthUp(false,true)and i:DebuffRefreshable(W.RakeDebuff))then if p(W.Rake,nil,nil,not i:IsInMeleeRange(10))then m.ReturnShouldcast=1822;return"rake cat 2"end end;if W.AdaptiveSwarm:IsCastable()and O[12]and g:BuffUp(W.CatForm)then if p(W.AdaptiveSwarm)then m.ReturnShouldcast=391888;return"adaptive_swarm cat 12"end end;if W.ConvoketheSpirits:IsCastable()and o()and((g:BuffUp(W.HeartoftheWildBuff)or W.HeartoftheWild:CooldownRemains()>60-30 or not W.HeartoftheWild:IsAvailable())and g:BuffUp(W.CatForm)and g:Energy()<50 and(g:ComboPoints()<5 and i:DebuffRemains(W.RipDebuff)>5 or _>1))then if p(W.ConvoketheSpirits,nil,nil,not i:IsInRange(30))then return"convoke_the_spirits cat 18"end end;if W.HeartoftheWild:IsCastable()and o()and(W.ConvoketheSpirits:CooldownRemains()<30 and g:BuffDown(W.HeartoftheWildBuff)and i:DebuffUp(W.SunfireDebuff)and(i:DebuffUp(W.MoonfireDebuff)or _>4+8))then if p(W.HeartoftheWild,nil)then m.ReturnShouldcast=319454;return"heart_of_the_wild cat 26"end end;if W.CatForm:IsReady()and(g:BuffDown(W.CatForm)and g:Energy()>50)then if p(W.CatForm)then m.ReturnShouldcast=768;return"cat_form cat 28"end end;if W.FerociousBite:IsReady()and((g:ComboPoints()>3 or g:ComboPoints()==5)and g:Energy()>=50 and i:DebuffRemains(W.RipDebuff)>10 and _<4)then if p(W.FerociousBite,nil,nil,not i:IsInMeleeRange(5))then m.ReturnShouldcast=22568;return"ferocious_bite cat 32"end end;if W.Rip:IsReady()and _<11 then if L.CastCycle(W.Rip,Z,aj,not i:IsInMeleeRange(5))then m.ReturnShouldcast=1079;return"rip cat 34"end end;if W.Rake:IsReady()and _<5 then if L.CastCycle(W.Rake,Z,ak,not i:IsInMeleeRange(5))then m.ReturnShouldcast=1822;return"rake cat 36"end end;if W.Swipe:IsReady()and _>=2 then if p(W.Swipe,nil,nil,not i:IsInMeleeRange(8))then m.ReturnShouldcast=213764;return"swipe cat 38"end end;if W.Rake:IsReady()and((g:ComboPoints()<5 or g:Energy()>90)and i:PMultiplier(W.Rake)<=g:PMultiplier(W.Rake))then if L.CastCycle(W.Rake,Z,ak,not i:IsInMeleeRange(5))then m.ReturnShouldcast=1822;return"rake cat 40"end end;if W.Shred:IsReady()and(g:ComboPoints()<5 or g:Energy()>90)then if p(W.Shred,nil,nil,not i:IsInMeleeRange(5))then m.ReturnShouldcast=5221;return"shred cat 42"end end end;local function az()if W.HeartoftheWild:IsCastable()and o()and((W.ConvoketheSpirits:CooldownRemains()<30 or W.ConvoketheSpirits:CooldownRemains()>90)and g:BuffDown(W.HeartoftheWildBuff))then if p(W.HeartoftheWild,nil)then m.ReturnShouldcast=319454;return"heart_of_the_wild owl 2"end end;if W.MoonkinForm:IsReady()and g:BuffDown(W.MoonkinForm)then if p(W.MoonkinForm)then m.ReturnShouldcast=197625;return"moonkin_form owl 6"end end;local aA=true;if W.ConvoketheSpirits:IsCastable()and aA and o()and((g:BuffUp(W.HeartoftheWildBuff)or W.HeartoftheWild:CooldownRemains()>60-30 or not W.HeartoftheWild:IsAvailable())and(g:BuffRemains(W.EclipseSolar)>4 or g:BuffRemains(W.EclipseLunar)>4)and(not X.SoullettingRuby:IsEquipped()or X.SoullettingRuby:CooldownRemains()<114-60 and not X.SoullettingRuby:IsReady()))then if p(W.ConvoketheSpirits,nil,nil,not i:IsInRange(35))then m.ReturnShouldcast=391528;return"convoke_the_spirits owl 8"end end;if W.Starsurge:IsReady()and(_<6 or not a2 and _<8)then if p(W.Starsurge,nil,nil,not i:IsSpellInRange(W.Starsurge))then m.ReturnShouldcast=197626;return"starsurge owl 14"end end;if W.Moonfire:IsReady()and(_<5 or not a2 and _<7)then if L.CastCycle(W.Moonfire,Z,am,not i:IsSpellInRange(W.Moonfire))then m.ReturnShouldcast=8921;return"moonfire owl 16"end end;if W.Sunfire:IsReady()then if L.CastCycle(W.Sunfire,Z,am,not i:IsSpellInRange(W.Sunfire))then m.ReturnShouldcast=93402;return"sunfire owl 18"end end;if W.Wrath:IsReady()and(a3 and _==1 or a4 or a6 and _>1)then if p(W.Wrath,nil,nil,not i:IsSpellInRange(W.Wrath))then m.ReturnShouldcast=5176;return"wrath owl 20"end end;if W.Starfire:IsReady()then if p(W.Starfire,nil,nil,not i:IsSpellInRange(W.Starfire))then m.ReturnShouldcast=197628;return"starfire owl 22"end end end;local function aB()O[3]=HeroRotationCharDB.Toggles[4]O[2]=HeroRotationCharDB.Toggles[5]O[1]=HeroRotationCharDB.Toggles[15]end;local function aC()m.Reset()aB()if g:IsDeadOrGhost()then return end end;local function aD()if X.Healthstone:IsReady()and R and g:HealthPercentage()<=V then if p(X.Healthstone)then return"Cast Healthstone"end end;if X.HealPot:IsReady()and P and g:HealthPercentage()<=T then if p(X.HealPot)then return"Cast Healthstone"end end;if W.Barkskin:IsReady()and O[5]and g:HealthPercentage()<=O[6]then if p(W.Barkskin)then m.ReturnShouldcast=22812;return"Cast Barkskin"end end;if W.Renewal:IsReady()and O[7]and g:HealthPercentage()<=O[8]then if p(W.Renewal)then m.ReturnShouldcast=108238;return"Cast Renewal"end end end;local function aE()if g:AffectingCombat()and O[10]and W.Ironbark:IsReady()and q:HealthPercentage()<=O[9]then if m.Cast(W.Ironbark)then m.ReturnShouldcast=9102342;return"ironbark 2"end end;if g:AffectingCombat()and O[11]and W.AdaptiveSwarm:IsCastable()then if m.Cast(W.AdaptiveSwarm)then m.ReturnShouldcast=391888;return"adaptive_swarm 4"end end;if g:AffectingCombat()and O[13]and L.UnitGroupRole(q)=="TANK"and L.FriendlyUnitsWithBuffCount(W.Lifebloom,true,false)<1 and q:HealthPercentage()<=O[14]-M(g:BuffUp(W.CatForm))*15 and W.Lifebloom:IsCastable()and q:BuffRefreshable(W.Lifebloom)then if m.Cast(W.Lifebloom)then m.ReturnShouldcast=9188550;return"lifebloom 6 healing tank"end end;if g:AffectingCombat()and O[15]and L.UnitGroupRole(q)~="TANK"and L.FriendlyUnitsWithBuffCount(W.Lifebloom,false,true)<1 and(W.Undergrowth:IsAvailable()or L.IsSoloMode())and q:HealthPercentage()<=O[16]-M(g:BuffUp(W.CatForm))*15 and W.Lifebloom:IsCastable()and q:BuffRefreshable(W.Lifebloom)then if p(W.Lifebloom)then m.ReturnShouldcast=9188550;return"lifebloom 6 healing anyone"end end;if g:AffectingCombat()and O[17]and o()and W.ConvokeTheSpirits:IsReady()and L.AreUnitsBelowHealthPercentage(O[19],O[18],W.Regrowth)then if p(W.ConvokeTheSpirits)then m.ReturnShouldcast=391528;return"convoke_the_spirits healing"end end;if g:AffectingCombat()and W.CenarionWard:IsReady()and O[40]and q:HealthPercentage()<=O[41]then if p(W.CenarionWard)then m.ReturnShouldcast=9102351;return"cenarion_ward healing"end end;if g:AffectingCombat()and g:BuffUp(W.NaturesSwiftness)and W.Regrowth:IsCastable()then if p(W.Regrowth)then m.ReturnShouldcast=98936;return"regrowth_swiftness healing"end end;if g:AffectingCombat()and W.NaturesSwiftness:IsReady()and O[20]and q:HealthPercentage()<=O[21]then if p(W.NaturesSwiftness)then m.ReturnShouldcast=132158;return"natures_swiftness healing"end end;if g:AffectingCombat()and O[22]and W.GroveGuardians:IsReady()and W.GroveGuardians:TimeSinceLastCast()>5 and L.AreUnitsBelowHealthPercentage(O[23],O[24],W.Regrowth)then if p(W.GroveGuardians)then m.ReturnShouldcast=9102693;return"grove_guardians healing"end end;if o()and W.Flourish:IsReady()and g:BuffDown(W.Flourish)and an()>4 and L.AreUnitsBelowHealthPercentage(O[25],O[26],W.Regrowth)then if p(W.Flourish)then m.ReturnShouldcast=9197721;return"flourish healing"end end;if g:AffectingCombat()and o()and W.Tranquility:IsReady()and L.AreUnitsBelowHealthPercentage(O[27],O[28],W.Regrowth)then if p(W.Tranquility)then m.ReturnShouldcast=740;return"tranquility_tree healing"end end;if g:AffectingCombat()and o()and W.Tranquility:IsReady()and g:BuffUp(W.IncarnationBuff)and L.AreUnitsBelowHealthPercentage(O[29],O[30],W.Regrowth)then if p(W.Tranquility)then m.ReturnShouldcast=740;return"tranquility_tree healing"end end;if g:AffectingCombat()and W.Efflorescence:TimeSinceLastCast()>75 then if p(W.Efflorescence)then m.ReturnShouldcast=6145205;return"efflorescence healing player"end end;if g:AffectingCombat()and W.Wildgrowth:IsReady()and O[31]and L.AreUnitsBelowHealthPercentage(O[32],O[33],W.Regrowth)and(not W.Swiftmend:IsAvailable()or not W.Swiftmend:IsReady())then if p(W.Wildgrowth)then m.ReturnShouldcast=48438;return"wildgrowth healing"end end;if g:AffectingCombat()and W.Regrowth:IsCastable()and O[34]and q:HealthPercentage()<=O[35]then if p(W.Regrowth)then m.ReturnShouldcast=98936;return"regrowth healing"end end;if g:AffectingCombat()and g:BuffUp(W.Innervate)and aq()>0 and r and r:Exists()and r:BuffRefreshable(W.Rejuvenation)then if p(W.Rejuvenation)then m.ReturnShouldcast=9774;return"rejuvenation_cycle healing"end end;if g:AffectingCombat()and W.Rejuvenation:IsCastable()and O[36]and q:BuffRefreshable(W.Rejuvenation)and q:HealthPercentage()<=O[37]then if p(W.Rejuvenation)then m.ReturnShouldcast=9774;return"rejuvenation healing"end end;if g:AffectingCombat()and W.Regrowth:IsCastable()and O[39]and q:BuffUp(W.Rejuvenation)and q:HealthPercentage()<=O[38]then if p(W.Regrowth)then m.ReturnShouldcast=98936;return"regrowth healing"end end end;local function aF()if W.Rejuvenation:IsCastable()and not ap(q)then if p(W.Rejuvenation)then m.ReturnShouldcast=9774;return"rejuvenation ramp"end end;if W.Swiftmend:IsReady()and not ap(q)and g:BuffDown(W.SoulOfTheForestBuff)then if p(W.Rejuvenation)then m.ReturnShouldcast=9774;return"rejuvenation ramp"end end;if W.Swiftmend:IsReady()and ao(q)and q:HealthPercentage()<=95 then if p(W.Swiftmend)then m.ReturnShouldcast=918562;return"swiftmend ramp"end end;if g:BuffUp(W.SoulOfTheForestBuff)and W.Wildgrowth:IsReady()then if p(W.Wildgrowth,nil,true)then m.ReturnShouldcast=48438;return"wildgrowth ramp"end end;if W.Innervate:IsReady()and g:BuffDown(W.Innervate)then if p(W.Innervate,nil,nil,true)then m.ReturnShouldcast=29166;return"innervate ramp"end end;if g:BuffUp(W.Innervate)and ar()>0 and r and r:Exists()and r:BuffRefreshable(W.Rejuvenation)then if p(W.Rejuvenation)then m.ReturnShouldcast=00000;return"rejuvenation_cycle ramp MO"end end end;local function aG()aC()if n()then B=g:GetEnemiesInSplashRange(40)C=#B;Z=i:GetEnemiesInSplashRange(8)_=#Z else Z={}B={}C=1;_=1 end;if L.TargetIsValid()or g:AffectingCombat()then D=d.BossFightRemains()E=D;if E==11111 then E=d.FightRemains(Z,false)end end;if W.MarkoftheWild:IsCastable()and(L.GroupBuffMissing(W.MarkoftheWildBuff)or not g:BuffUp(W.MarkoftheWild))and W.MarkoftheWild:TimeSinceLastCast()>10 then if p(W.MarkoftheWild)then m.ReturnShouldcast=1126;return"mark_of_the_wild buff refre"end end;local aH=true;local aI=true;F=aD()if F then return"Defensives: "..F end;if L.TargetIsValid()and(g:AffectingCombat()or O[2])then if aH or O[2]then if L.IsTankBelowHealthPercentage(O[9],6+14,W.Regrowth)and W.Ironbark:IsReady()then L.FocusUnit(aI,20,"TANK",20,W.Regrowth)else L.FocusUnit(aI,20,nil,20,W.Regrowth)end;if q:Exists()then F=aF()if F then return"Cast "..F end;F=aE()if F then return"Cast "..F end end end;ah()if not g:AffectingCombat()then local F=ax()if F then return F end end;if L.getUnitsAverageHealthPercentage(O[4])<=3 then if W.Sunfire:IsReady()and i:DebuffRefreshable(W.SunfireDebuff)then if p(W.Sunfire,nil,nil,not i:IsSpellInRange(W.Sunfire))then m.ReturnShouldcast=93402;return"sunfire main 24"end end;if W.Moonfire:IsReady()and i:DebuffRefreshable(W.MoonfireDebuff)then if p(W.Moonfire,nil,nil,not i:IsSpellInRange(W.Moonfire))then m.ReturnShouldcast=8921;return"moonfire main 26"end end;if o()and W.Berserking:IsCastable()then if p(W.Berserking,nil)then m.ReturnShouldcast=26297;return"berserking main 2"end end;if W.CatForm:IsAvailable()and _>=1 then local F=ay()if F then return F end end;if W.AdaptiveSwarm:IsCastable()and O[12]then if p(W.AdaptiveSwarm)then m.ReturnShouldcast=391888;return"adaptive_swarm cat 12"end end;if W.MoonkinForm:IsAvailable()and not(_>=1)and C>=1 then local F=az()if F then return F end end;if W.ConvoketheSpirits:IsCastable()and o()and((g:BuffUp(W.HeartoftheWildBuff)or W.HeartoftheWild:CooldownRemains()>60-30 or not W.HeartoftheWild:IsAvailable())and(not X.SoullettingRuby:IsEquipped()or X.SoullettingRuby:CooldownRemains()<114 and not X.SoullettingRuby:IsReady()))then if p(W.ConvoketheSpirits,nil,nil,not i:IsInRange(35))then m.ReturnShouldcast=391528;return"convoke_the_spirits main 18"end end;if W.Wrath:IsReady()and not g:BuffUp(W.CatForm)and not Z then if p(W.Wrath,nil,nil,not i:IsSpellInRange(W.Wrath))then m.ReturnShouldcast=5176;return"wrath main 28"end end end;if true then if m.CastAnnotated(W.Pool,false,"WAIT")then return"Wait/Pool Resources"end end end end;local function aJ()end;m.SetAPL(105,aG,aJ)