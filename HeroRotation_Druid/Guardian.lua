local a,b=...local c=HeroDBC.DBC;local d=HeroLib;local e=HeroCache;local f=d.Unit;local g=f.Player;local h=f.Pet;local i=f.Target;local j=d.Spell;local k=d.MultiSpell;local l=d.Item;local m=HeroRotation;local n=m.AoEON;local o=m.CDsON;local p=m.Cast;local q=HeroRotationCharDB.Toggles[4]local r=HeroRotationCharDB.Toggles[5]local s=HeroRotationCharDB.Toggles[15]local t=HeroRotationCharDB.Toggles[12]local u=HeroRotationCharDB.Toggles[70]local v=HeroRotationCharDB.Toggles[71]local w=HeroRotationCharDB.Toggles[72]local x=HeroRotationCharDB.Toggles[73]local y=HeroRotationCharDB.Toggles[74]local z=HeroRotationCharDB.Toggles[75]local A=HeroRotationCharDB.Toggles[76]local B=HeroRotationCharDB.Toggles[77]local C=HeroRotationCharDB.Toggles[78]local D=HeroRotationCharDB.Toggles[79]local E=true;local F=math.floor;local G=false;local H={324736,228318,178658,333227,334800,334967,324737,326450,334470,320703,320012,324085,333241,331510,344739,368477,368396,355057,356133,342139,353706,355782,327155,359668}local I={325552,326836,326092,334926,328395,330725,333299,323831,328494,322968,334496,334493,319603}local J,K;local L=m.Commons.Everyone;local M={General=m.GUISettings.General,Commons=m.GUISettings.APL.Druid.Commons,Guardian=m.GUISettings.APL.Druid.Guardian,Guardian2=m.GUISettings.APL.Druid.Guardian2}local N=j.Druid.Guardian;local O=l.Druid.Guardian;local P={}local Q=g:GetEquipment()local R=l(0)local S=l(0)if Q[13]then R=l(Q[13])end;if Q[14]then S=l(Q[14])end;local T;local U;local V;local W=0;local X=0;local Y=0;local Z=N.ThornsofIron:IsAvailable()and N.ReinforcedFur:IsAvailable()local _,a0;local a1,a2;local a3;local a4,a5;local a6=g:HasLegendaryEquipped(58)local a7=g:HasLegendaryEquipped(49)local a8=g:HasLegendaryEquipped(48)local a9=g:HasLegendaryEquipped(60)local aa=g:CovenantID()d:RegisterForEvent(function()aa=g:CovenantID()end,"COVENANT_CHOSEN")d:RegisterForEvent(function()Q=g:GetEquipment()R=l(0)S=l(0)if Q[13]then R=l(Q[13])end;if Q[14]then S=l(Q[14])end;a6=g:HasLegendaryEquipped(58)a7=g:HasLegendaryEquipped(49)a8=g:HasLegendaryEquipped(48)a9=g:HasLegendaryEquipped(60)end,"PLAYER_EQUIPMENT_CHANGED")d:RegisterForEvent(function()N.AdaptiveSwarmCov:RegisterInFlight()end,"LEARNED_SPELL_IN_TAB")N.AdaptiveSwarmCov:RegisterInFlight()local function ab(ac)if ac then return 1 else return 0 end end;local function ad(ac)return ac~=0 end;local function ae(af)local ag=0;for ah in pairs(af)do local ai=af[ah]if ai:IsChanneling(j(240784))then ag=ag+1 end end;return ag end;local function aj(af)local ak=0;for ah in pairs(af)do local ai=af[ah]if ai:CastRemains()<=g:GCD()+0.25 and ai:IsCasting(j(240784))then ak=ak+1 end end;return ak end;local function al(af)local am=0;for ah in pairs(af)do local ai=af[ah]if ai:NPCID()==118044 then am=am+1 end end;return am end;local function an(af)local ao=0;for ah in pairs(af)do local ai=af[ah]if ai:NPCID()==118065 or ai:NPCID()==118032 then ao=ao+1 end end;return ao end;local function ap(aq)if aq:DebuffRefreshable(N.MoonfireDebuff)and aq:TimeToDie()>12 and(aq:AffectingCombat()or aq:IsDummy()or aq:NPCID()==153285)and aq:GUID()==f("mouseover"):GUID()and M.Guardian.TargetSwap=="Mouseover"and aq:NPCID()~=118044 then W=18921;return true elseif aq:DebuffRefreshable(N.MoonfireDebuff)and aq:TimeToDie()>12 and(aq:AffectingCombat()or aq:IsDummy()or aq:NPCID()==153285)and M.Guardian.TargetSwap=="AutoSwap"and aq:GUID()~=i:GUID()and not t and aq:NPCID()~=118044 then W=9999;if W==999 then starttime=GetTime()endtime=starttime+0.25 elseif W>0 and endtime~=nil and GetTime()>endtime then W=0 end;return true elseif aq:DebuffRefreshable(N.MoonfireDebuff)and aq:TimeToDie()>12 and(aq:AffectingCombat()or aq:IsDummy()or aq:NPCID()==153285)and aq:GUID()==i:GUID()and aq:NPCID()~=118044 then X=8921;return true elseif aq:DebuffRefreshable(N.MoonfireDebuff)and aq:TimeToDie()>12 and(aq:AffectingCombat()or aq:IsDummy()or aq:NPCID()==153285)and aq:NPCID()~=118044 then return true end end;local function ar(aq)if not g:IsTanking(aq)and w and aq:AffectingCombat()and aq:GUID()==f("mouseover"):GUID()and aq:NPCID()~=118044 then W=16795;return true elseif not g:IsTanking(aq)and w and aq:AffectingCombat()and aq:GUID()==i:GUID()and aq:NPCID()~=118044 then X=6795;return true elseif not g:IsTanking(aq)and w and aq:AffectingCombat()and aq:NPCID()~=118044 then return true end end;local function as(aq)if aq:DebuffRefreshable(N.MoonfireDebuff)and(aq:NPCID()==118032 or aq:NPCID()==118065)and aq:GUID()==f("mouseover"):GUID()and aq:NPCID()~=118044 then W=18921;return true elseif aq:DebuffRefreshable(N.MoonfireDebuff)and(aq:NPCID()==118032 or aq:NPCID()==118065)and aq:GUID()==f("target"):GUID()and aq:NPCID()~=118044 then X=8921;return true elseif aq:DebuffRefreshable(N.MoonfireDebuff)and(aq:NPCID()==118032 or aq:NPCID()==118065)then return true end end;local function at(aq)if aq:DebuffRefreshable(N.SunfireDebuff)and aq:NPCID()==118065 and aq:GUID()==f("mouseover"):GUID()and aq:NPCID()~=118044 then W=2197630;return true elseif aq:DebuffRefreshable(N.SunfireDebuff)and aq:NPCID()==118065 and aq:GUID()==f("target"):GUID()and aq:NPCID()~=118044 then X=197630;return true elseif aq:DebuffRefreshable(N.SunfireDebuff)and aq:NPCID()==118065 then return true end end;local function au(aq)return aq:DebuffRefreshable(N.ThrashDebuff)or aq:DebuffStack(N.ThrashDebuff)<3 or aq:DebuffStack(N.ThrashDebuff)<4 and a6 or a5>=4 or g:BuffUp(N.BerserkBuff)and g:BuffRemains(N.BerserkBuff)<=g:GCD()+0.5 end;local function av(aq)if aq:DebuffStack(N.ThrashDebuff)>2 and(aq:AffectingCombat()or aq:IsDummy()or aq:NPCID()==153285)and aq:GUID()==f("mouseover"):GUID()and M.Guardian.TargetSwap=="Mouseover"then W=180313;return true elseif aq:DebuffStack(N.ThrashDebuff)>2 and(aq:AffectingCombat()or aq:IsDummy()or aq:NPCID()==153285)and M.Guardian.TargetSwap=="AutoSwap"and aq:GUID()~=i:GUID()and not t then W=9999;if W==999 then starttime=GetTime()endtime=starttime+0.25 elseif W>0 and endtime~=nil and GetTime()>endtime then W=0 end;return true elseif aq:DebuffStack(N.ThrashDebuff)>2 and(aq:AffectingCombat()or aq:IsDummy()or aq:NPCID()==153285)and aq:GUID()==i:GUID()then X=80313;return true elseif aq:DebuffStack(N.ThrashDebuff)>2 and(aq:AffectingCombat()or aq:IsDummy()or aq:NPCID()==153285)then return true end;return aq:DebuffStack(N.ThrashDebuff)>2 end;local function aw()if g:HealthPercentage()<M.Guardian2.FrenziedRegenHP and N.FrenziedRegeneration:IsReady()and g:BuffDown(N.FrenziedRegenerationBuff)and g:BuffUp(N.BearForm)then if p(N.FrenziedRegeneration,nil,nil)then X=22842;return"frenzied_regeneration defensive 2"end end;if N.Ironfur:IsCastable()and not G and g:BuffUp(N.BearForm)and N.ConvoketheSpirits:TimeSinceLastDisplay()>1 and(g:Rage()>=N.Ironfur:Cost()+1 and(U or i:IsDummy()or i:NPCID()==153285)and(g:BuffDown(N.IronfurBuff)or g:BuffStack(N.IronfurBuff)<2 and g:BuffRefreshable(N.Ironfur)or g:Rage()>=90))then if p(N.Ironfur,nil,nil)then X=192081;return"ironfur defensive 4"end end;local ax=g:GetUseableTrinkets(P)if ax then if p(ax,nil,nil)then if ax:ID()==TopTrinketID and M.Commons.Enabled.TopTrinket and M.Commons.TopTrinketHP>g:HealthPercentage()then X=24;return"top trinket 1 defensive"elseif ax:ID()==BotTrinketID and M.Commons.Enabled.BotTrinket and M.Commons.BotTrinketHP>g:HealthPercentage()then X=30;return"bot trinket 1 defensive"end end end;if N.Renewal:IsCastable()and g:HealthPercentage()<M.Guardian2.RenewalHP then if p(N.Renewal,nil,nil)then X=108238;return"Renewal defensive 4"end end;if N.Barkskin:IsCastable()and select(8,GetInstanceInfo())~=1698 and g:HealthPercentage()<M.Guardian2.BarkskinHP then if p(N.Barkskin,nil,nil)then X=22812;return"barkskin defensive 6"end end;if N.SurvivalInstincts:IsCastable()and g:HealthPercentage()<M.Guardian2.SurvivalInstinctsHP then if p(N.SurvivalInstincts,nil,nil)then X=61336;return"survival_instincts defensive 8"end end;if N.BristlingFur:IsCastable()and g:Rage()<M.Guardian2.BristlingFurRage then if p(N.BristlingFur,nil,nil)then X=155835;return"bristling_fur defensive 10"end end;if g:HealthPercentage()<M.Guardian2.PhialHP and O.PhialofSerenity:IsReady()and O.PhialofSerenity:CooldownRemains()<=0 then if m.Cast(O.PhialofSerenity,nil)then X=55;return"PhialofSerenity HP"end end;if g:HealthPercentage()<M.Guardian2.HealthstoneHP and O.Healthstone:IsReady()and O.Healthstone:CooldownRemains()<=0 then if m.Cast(O.Healthstone,nil)then X=40;return"Healthstone HP"end end;if g:HealthPercentage()<M.Guardian2.HealPotHP and O.CosmicHealPot:IsReady()and O.CosmicHealPot:CooldownRemains()<=0 then if m.Cast(O.CosmicHealPot,nil)then X=45;return"CosmicHealPot HP"end end;if g:HealthPercentage()<M.Guardian2.HealPotHP and O.HealPot:IsReady()and O.HealPot:CooldownRemains()<=0 then if m.Cast(O.HealPot,nil)then X=41;return"HealPot HP"end end end;local function ay()if N.BearForm:IsCastable()and g:BuffDown(N.BearForm)and not select(8,GetInstanceInfo())==1698 then if p(N.BearForm)then X=5487;return"bear_form precombat 2"end end;if N.Wrath:IsCastable()and(u or select(8,GetInstanceInfo())==1698)and g:BuffUp(N.MoonkinForm)and(aa~=3 or select(8,GetInstanceInfo())==1698)then if p(N.Wrath)then X=5176;return"cat_form precombat 2"end end;if N.Starfire:IsCastable()and(u or select(8,GetInstanceInfo())==1698)and g:BuffUp(N.MoonkinForm)and aa==3 then if p(N.Starfire)then X=197628;return"cat_form precombat 2"end end;if N.Fleshcraft:IsCastable()and E and not g:IsMoving()and(N.PustuleEruption:SoulbindEnabled()or N.VolatileSolvent:SoulbindEnabled())then if p(N.Fleshcraft,nil,nil)then X=324631;return"fleshcraft precombat 3"end end;if N.WildCharge:IsCastable()and(i:IsInRange(25)and not i:IsInRange(8))and not select(8,GetInstanceInfo())==1698 then if p(N.WildCharge)then X=102401;return"wild_charge precombat 4"end end;if N.Rake:IsCastable()and g:BuffUp(N.Prowl)and not select(8,GetInstanceInfo())==1698 then if p(N.Rake)then X=1822;return"Rake cat 2"end end;if N.Mangle:IsCastable()and i:IsInMeleeRange(5)and g:BuffUp(N.BearForm)and not select(8,GetInstanceInfo())==1698 then if p(N.Mangle)then X=33917;return"mangle precombat 6"end end;if N.Thrash:IsCastable()and i:IsInMeleeRange(8)and g:BuffUp(N.BearForm)and not select(8,GetInstanceInfo())==1698 then if p(N.Thrash)then X=77758;return"thrash precombat 8"end end;if N.Moonfire:IsCastable()and i:NPCID()~=118044 then if p(N.Moonfire,nil,nil,not i:IsSpellInRange(N.Moonfire))then X=8921;return"moonfire precombat 10"end end end;local function az()if N.MoonkinForm:IsCastable()and g:BuffDown(N.MoonkinForm)then if p(N.MoonkinForm)then X=197625;return"owl_form owl 2"end end;if N.HeartoftheWild:IsCastable()and o()and N.HeartoftheWild:IsAvailable()and g:BuffDown(N.HeartoftheWild)then if p(N.HeartoftheWild)then X=319454;return"HOTW owl 2"end end;if N.ConvoketheSpirits:IsCastable()and g:BuffUp(N.MoonkinForm)and E and(N.FirstStrike:SoulbindEnabled()and g:BuffUp(N.FirstStrike))then if p(N.ConvoketheSpirits)then X=323764;return"Convoke owl 2"end end;if N.ConvoketheSpirits:IsCastable()and E and g:BuffUp(N.MoonkinForm)and(N.HeartoftheWild:IsAvailable()and(g:BuffUp(N.HeartoftheWild)or N.HeartoftheWild:CooldownRemains()>15)or not N.HeartoftheWild:IsAvailable()or not o())then if p(N.ConvoketheSpirits)then X=323764;return"Convoke owlvoke 2"end end end;local function aA()if N.CatForm:IsCastable()and g:BuffDown(N.CatForm)then if p(N.CatForm)then X=768;return"catform catvoke 2"end end;if N.HeartoftheWild:IsCastable()and o()and N.HeartoftheWild:IsAvailable()and g:BuffDown(N.HeartoftheWild)then if p(N.HeartoftheWild)then X=319454;return"HOTW catvoke 2"end end;if N.ConvoketheSpirits:IsCastable()and E and g:BuffUp(N.CatForm)and(N.FirstStrike:SoulbindEnabled()and g:BuffUp(N.FirstStrikeBuff)or N.HeartoftheWild:IsAvailable()and(g:BuffUp(N.HeartoftheWild)or N.HeartoftheWild:CooldownRemains()>15)or not N.HeartoftheWild:IsAvailable()or not o())then if p(N.ConvoketheSpirits)then X=323764;return"Convoke catvoke 2"end end end;local function aB()if N.BearForm:IsCastable()and g:BuffDown(N.BearForm)then if p(N.BearForm)then X=5487;return"bear_form bear 2"end end;if N.Growl:IsReady()and g:AffectingCombat()and(not g:IsTanking(i)and w)then if p(N.Growl,nil)then X=6795;return"Growl bear 3"end end;if N.Growl:IsReady()then if L.CastCycle(N.Growl,Enemies40y,ar,not i:IsSpellInRange(N.Growl))then return"Growl bear 4"end end;if N.HeartoftheWild:IsCastable()and o()and i:IsInMeleeRange(8)and u and N.BalanceAffinity:IsAvailable()then if p(N.HeartoftheWild,nil)then X=319454;return"heart_of_the_wild bear 3"end end;if N.Moonfire:IsReady()and not g:BuffUp(N.RavenousFrenzyBuff)then if ap(i)then if p(N.Moonfire)then X=8921;return"Moonfire bear 4"end end;if L.CastCycle(N.Moonfire,a4,ap,not i:IsSpellInRange(N.Moonfire))then return"moonfire bear 4"end end;if N.Barkskin:IsReady()and g:BuffDown(N.BearForm)then if p(N.Berserking,nil)then X=26297;return"berserking bear 15"end end;if N.ConvoketheSpirits:IsReady()and o()then if p(N.ConvoketheSpirits)then X=391528;return"Convoke Spirits Bear"end end;if N.Ironfur:IsCastable()and N.ConvoketheSpirits:TimeSinceLastDisplay()>1 and g:Rage()>=N.Ironfur:Cost()+1 and not V and(g:BuffUp(N.IncarnationBuff)or g:BuffUp(N.BerserkBuff))then if p(N.Ironfur,nil,nil)then X=192081;return"ironfur Zerk 1"end end;if N.Berserking:IsCastable()and i:IsInMeleeRange(8)and(g:BuffUp(N.BerserkBuff)or g:BuffUp(N.IncarnationBuff))then if p(N.Berserking,nil)then X=26297;return"berserking bear 15"end end;if aa==2 and i:IsInMeleeRange(8)then local ax=g:GetUseableTrinkets(P)if ax then if p(ax,nil,nil)then if ax:ID()==TopTrinketID and M.Commons.Enabled.TopTrinket and(M.Commons.TopTrinketHP<=0 and o()or M.Commons.TopTrinketHP>g:HealthPercentage())then X=24;return"top trinket 1"elseif ax:ID()==BotTrinketID and M.Commons.Enabled.BotTrinket and(M.Commons.BotTrinketHP<=0 and o()or M.Commons.BotTrinketHP>g:HealthPercentage())then X=30;return"top trinket 2"end end end end;if N.Thrash:IsCastable(BypassRecovery)and i:IsInMeleeRange(8)and(a9 or g:BuffUp(N.IncarnationBuff)and a5>3)and select(8,GetInstanceInfo())~=1698 then if p(N.Thrash)then X=77758;return"thrash bear 30"end end;if N.Mangle:IsCastable()and i:IsInMeleeRange(8)and not a9 and(g:BuffUp(N.IncarnationBuff)and a5<=3)and(i:DebuffStack(N.ThrashDebuff)==3 and i:DebuffRemains(N.ThrashDebuff)>=3)and i:DebuffRemains(N.MoonfireDebuff)>=3 then if p(N.Mangle,nil,nil,not i:IsInMeleeRange(5))then X=33917;return"mangle bear 134"end end;if N.RavenousFrenzy:IsCastable()and E and i:IsInMeleeRange(8)then if p(N.RavenousFrenzy,nil,nil)then X=323546;return"ravenous_frenzy bear 7"end end;if N.Raze:IsReady()and not Z and((g:BuffUp(N.IncarnationBuff)or g:BuffUp(N.BerserkBuff))and K>1 and(N.RageoftheSleeper:CooldownRemains()>3 or g:BuffUp(N.RageoftheSleeper)))then if p(N.Raze,nil,nil,not a1)then X=400254;return"raze bear 30"end end;if M.Commons.Enabled.Potions and s and i:IsInMeleeRange(8)and O.PotionofPhantomFire:IsReady()and(aa==2 and g:BuffRemains(N.IncarnationBuff)>=23 and g:BuffRemains(N.IncarnationBuff)<=26 and not m.GUISettings.General.HoldPotforBL or m.GUISettings.General.HoldPotforBL and g:BloodlustUp())then if p(O.PotionofPhantomFire,nil,nil)then X=50;return"potion bear 11"end end;if N.ConvoketheSpirits:IsCastable()and E and i:IsInMeleeRange(8)then if p(N.ConvoketheSpirits,nil,nil,not i:IsInMeleeRange(5))then X=323764;return"convoke_the_spirits bear 12"end end;if N.Berserk:IsCastable()and not v and i:IsInMeleeRange(8)and o()and(U or i:IsDummy()or i:NPCID()==153285)and(g:BuffUp(N.RavenousFrenzyBuff)or aa~=2)then if p(N.Berserk,nil)then X=50334;return"berserk bear 13"end end;if N.Incarnation:IsCastable()and not v and i:IsInMeleeRange(8)and o()and g:HealthPercentage()<M.Guardian2.IGuardianOfUrsoc and(U or i:IsDummy()or i:NPCID()==153285)then if p(N.Incarnation,nil)then X=102558;return"incarnation bear 14"end end;if N.Raze:IsReady()and not Z and(K>1 and(N.RageoftheSleeper:CooldownRemains()>3 or g:BuffUp(N.RageoftheSleeper)))then if p(N.Raze,nil,nil,not a1)then X=400254;return"raze bear 38"end end;if N.Berserking:IsCastable()and i:IsInMeleeRange(8)and(g:BuffUp(N.BerserkBuff)or g:BuffUp(N.IncarnationBuff))then if p(N.Berserking,nil)then X=26297;return"berserking bear 15"end end;if N.Barkskin:IsCastable()and(U or i:IsDummy()or i:NPCID()==153285)and not M.Guardian.UseBarkskinDefensively and N.Brambles:IsAvailable()and select(8,GetInstanceInfo())~=1698 then if p(N.Barkskin,nil,nil)then X=22812;return"barkskin bear 17"end end;if N.AdaptiveSwarmCov:IsCastable()and i:IsInMeleeRange(8)and(i:DebuffDown(N.AdaptiveSwarmCovDebuff)and N.AdaptiveSwarmCov:TimeSinceLastCast()>0.3 and i:DebuffDown(N.AdaptiveSwarmCovDebuff)or g:BuffRemains(N.AdaptiveSwarmCovHeal)>3 or i:DebuffStack(N.AdaptiveSwarmCovDebuff)<3 and i:DebuffRemains(N.AdaptiveSwarmCovDebuff)<5 and i:DebuffUp(N.AdaptiveSwarmCovDebuff))then if p(N.AdaptiveSwarmCov,nil,nil,not i:IsSpellInRange(N.AdaptiveSwarmCov))then X=325727;return"adaptive_swarm bear 18"end end;if N.Raze:IsReady()and(g:BuffUp(N.ToothandClawBuff)and K>1 and(N.RageoftheSleeper:CooldownRemains()>3 or g:BuffUp(N.RageoftheSleeper)))then if p(N.Raze,nil,nil,not a1)then X=400254;return"raze bear 36"end end;if N.Raze:IsReady()and not Z and(K>1 and(N.RageoftheSleeper:CooldownRemains()>3 or g:BuffUp(N.RageoftheSleeper)))then if p(N.Raze,nil,nil,not a1)then X=400254;return"raze bear 38"end end;if N.RageoftheSleeper:IsCastable()or U and(g:BuffDown(N.IncarnationBuff)and N.Incarnation:CooldownRemains()>60 or g:BuffUp(N.IncarnationBuff)or N.ConvoketheSpirits:IsAvailable())and o()then if p(N.RageoftheSleeper,nil)then X=200851;return"RageoftheSleeper bear 16"end end;if N.Moonfire:IsCastable()and g:BuffUp(N.GalacticGuardianBuff)and select(8,GetInstanceInfo())==1698 and f("boss1"):NPCID()==117933 and f("boss1"):IsInRange(40)then if p(N.Moonfire)then X=118921;return"Moonfire owl Boss 2"end end;if N.Moonfire:IsReady()and(g:BuffUp(N.GalacticGuardianBuff)and a5<3)and not g:BuffUp(N.RavenousFrenzyBuff)then if p(N.Moonfire,nil,nil,not i:IsSpellInRange(N.Moonfire))then X=8921;return"moonfire bear 19"end end;if N.Thrash:IsCastable()and i:IsInMeleeRange(8)and(i:DebuffRefreshable(N.ThrashDebuff)or i:DebuffStack(N.ThrashDebuff)<3 or i:DebuffStack(N.ThrashDebuff)<4 and a6 or a5<=4)then if p(N.Thrash)then X=77758;return"thrash bear 20"end end;if N.Fleshcraft:IsCastable()and E and(N.PustuleEruption:SoulbindEnabled()and(N.Thrash:CooldownRemains()>0 and N.Mangle:CooldownRemains()>0 and i:DebuffRemains(N.MoonfireDebuff)>=3 and(g:BuffDown(N.IncarnationBuff)and g:BuffDown(N.BerserkBuff)and g:BuffDown(N.GalacticGuardianBuff)))or N.VolatileSolvent:SoulbindEnabled())then if p(N.Fleshcraft,nil,nil)then X=324631;return"fleshcraft bear 27"end end;if N.Swipe:IsCastable()and i:IsInMeleeRange(8)and(g:BuffDown(N.IncarnationBuff)and g:BuffDown(N.BerserkBuff)and a5>=4)then if p(N.Swipe,nil,nil,not i:IsInMeleeRange(8))then X=213771;return"swipe bear 28"end end;if N.Maul:IsReady()and i:IsInMeleeRange(8)and V and not G and(g:BuffUp(N.IncarnationBuff)and a5<3 and g:BuffStack(N.ToothandClawBuff)>=2 or g:BuffUp(N.ToothandClawBuff)and g:BuffRemains(N.ToothandClawBuff)<1.5 or a5<3)then if p(N.Maul,nil,nil,not i:IsInMeleeRange(5))then X=6807;return"maul bear 30"end end;if N.Maul:IsReady()and not G and a5>=3 and a5<3 and not N.ViciousCycle:IsAvailable()and V then if p(N.Maul,nil,nil,not i:IsInMeleeRange(5))then X=6807;return"maul bear 32"end end;if N.Mangle:IsCastable()and i:IsInMeleeRange(8)and(g:BuffUp(N.IncarnationBuff)and a5<=3 or g:Rage()<90 and a5<3 or g:Rage()<85 and a5<3 and N.SouloftheForest:IsAvailable()or g:BuffUp(N.GoreBuff))then if p(N.Mangle,nil,nil,not i:IsInMeleeRange(5))then X=33917;return"mangle bear 34"end end;if N.Thrash:IsCastable()and i:IsInMeleeRange(8)and a5>1 then if p(N.Thrash,nil,nil,not i:IsInMeleeRange(8))then X=77758;return"thrash bear 38"end end;if N.Pulverize:IsReady()and i:IsInMeleeRange(8)then if L.CastCycle(N.Pulverize,a4,av,not i:IsInMeleeRange(5))then return"pulverize bear 42"end end;if N.Thrash:IsCastable()and i:IsInMeleeRange(8)then if p(N.Thrash,nil,nil,not i:IsInMeleeRange(8))then X=77758;return"thrash bear 44"end end;if N.Maul:IsReady()and i:IsInMeleeRange(8)and V and not G and a5<3 then if p(N.Maul,nil,nil,not i:IsInMeleeRange(5))then X=6807;return"maul bear 46"end end;if N.Swipe:IsCastable()and i:IsInMeleeRange(8)then if p(N.Swipe,nil,nil,not i:IsInMeleeRange(8))then X=213771;return"swipe bear 48"end end end;local function aC()if N.CatForm:IsCastable()and g:BuffDown(N.CatForm)then if p(N.CatForm)then X=768;return"cat_form cat 2"end end;if N.Rake:IsCastable()and g:BuffUp(N.Prowl)then if p(N.Rake)then X=1822;return"Rake cat 2"end end;if N.HeartoftheWild:IsCastable()and N.HeartoftheWild:IsAvailable()and g:BuffDown(N.HeartoftheWild)and o()then if p(N.HeartoftheWild)then X=319454;return"HOTW cat 2"end end;if N.Rake:IsCastable()and(i:DebuffRefreshable(N.RakeDebuff)or g:Energy()<45)then if p(N.Rake)then X=1822;return"Rake cat 3"end end;if N.Rip:IsCastable()and i:DebuffRefreshable(N.Rip)and g:ComboPoints()>=1 then if p(N.Rip)then X=1079;return"Rip cat 2"end end;if N.ConvoketheSpirits:IsCastable()and E then if p(N.ConvoketheSpirits)then X=323764;return"Convoke cat 2"end end;if N.FerociousBite:IsCastable()and g:ComboPoints()>=4 and g:Energy()>50 then if p(N.FerociousBite)then X=22568;return"FB cat 2"end end;if N.AdaptiveSwarmCov:IsCastable()and E and(i:DebuffDown(N.AdaptiveSwarmCovDebuff)and N.AdaptiveSwarmCov:TimeSinceLastCast()>0.3 or i:DebuffStack(N.AdaptiveSwarmCovDebuff)<3 and i:DebuffRemains(N.AdaptiveSwarmCovDebuff)<5 and i:DebuffUp(N.AdaptiveSwarmCovDebuff))then if p(N.AdaptiveSwarmCov)then X=325727;return"Adaptive Swarm cat 2"end end;if N.Fleshcraft:IsCastable()and E and not g:IsMoving()and(N.PustuleEruption:SoulbindEnabled()and g:Energy()<35 or N.VolatileSolvent:SoulbindEnabled())then if p(N.Fleshcraft,nil,nil)then X=324631;return"fleshcraft precombat 3"end end;if true then if p(N.Swipe)then X=213771;return"Swipe cat 2"end end end;local function aD()if N.MoonkinForm:IsCastable()and g:BuffDown(N.MoonkinForm)then if p(N.MoonkinForm)then X=197625;return"owl_form owl 2"end end;if N.HeartoftheWild:IsCastable()and o()and N.HeartoftheWild:IsAvailable()and g:BuffDown(N.HeartoftheWild)then if p(N.HeartoftheWild)then X=319454;return"HOTW owl 2"end end;if N.Starsurge:IsCastable()and not g:IsMoving()then if p(N.Starsurge)then X=197626;return"Starsurge owl 2"end end;if N.ConvoketheSpirits:IsCastable()and E and N.FirstStrike:SoulbindEnabled()then if p(N.ConvoketheSpirits)then X=323764;return"Convoke owl 2"end end;if N.AdaptiveSwarmCov:IsCastable()and E and(i:DebuffDown(N.AdaptiveSwarmCovDebuff)and N.AdaptiveSwarmCov:TimeSinceLastCast()>0.3 or i:DebuffStack(N.AdaptiveSwarmCovDebuff)<3 and i:DebuffRemains(N.AdaptiveSwarmCovDebuff)<5 and i:DebuffUp(N.AdaptiveSwarmCovDebuff))then if p(N.AdaptiveSwarmCov)then X=325727;return"Adaptive Swarm cat 2"end end;if N.Sunfire:IsCastable()and i:DebuffRefreshable(N.SunfireDebuff)then if p(N.Sunfire)then X=197630;return"Sunfire owl 2"end end;if N.Sunfire:IsCastable()then if L.CastCycle(N.Sunfire,Enemies40y,at,not i:IsSpellInRange(N.Sunfire))then return"Sunfire Owl 3"end end;if N.Moonfire:IsCastable()and g:BuffUp(N.GalacticGuardianBuff)and select(8,GetInstanceInfo())==1698 and f("boss1"):NPCID()==117933 and f("boss1"):IsInRange(40)then if p(N.Moonfire)then X=118921;return"Moonfire owl Boss 2"end end;if N.Moonfire:IsCastable()and(i:DebuffRefreshable(N.MoonfireDebuff)or g:BuffUp(N.GalacticGuardianBuff))then if p(N.Moonfire)then X=8921;return"Moonfire owl 2"end end;if N.Starfire:IsCastable()and EclipseAnyNext and aa==3 and not g:IsMoving()then if p(N.Starfire)then X=197628;return"Starfire owl 2"end end;if N.Wrath:IsCastable()and EclipseAnyNext and aa~=3 and not g:IsMoving()then if p(N.Wrath)then X=5176;return"Wrath owl 2"end end;if N.ConvoketheSpirits:IsCastable()and E and(g:BuffUp(N.EclipseLunar)or g:BuffUp(N.EclipseSolar))then if p(N.ConvoketheSpirits)then X=323764;return"Convoke owl 2"end end;if N.Starfire:IsCastable()and not g:IsMoving()and(EclipseInLunar or EclipseSolarNext or EclipseInLunar and g:BuffUp(N.EclipseLunar)and N.Starsurge:TimeSinceLastCast()<14)then if p(N.Starfire)then X=197628;return"Starfire owl 2"end end;if N.Wrath:IsCastable()and not g:IsMoving()then if p(N.Wrath)then X=5176;return"Wrath owl 2"end end;if N.Moonfire:IsCastable()and g:IsMoving()then if p(N.Moonfire)then X=8921;return"Moonfire owl 2"end end end;local function aE()r=HeroRotationCharDB.Toggles[5]q=HeroRotationCharDB.Toggles[4]t=HeroRotationCharDB.Toggles[12]s=HeroRotationCharDB.Toggles[15]u=HeroRotationCharDB.Toggles[70]v=HeroRotationCharDB.Toggles[71]w=HeroRotationCharDB.Toggles[72]x=HeroRotationCharDB.Toggles[73]y=HeroRotationCharDB.Toggles[74]z=HeroRotationCharDB.Toggles[75]A=HeroRotationCharDB.Toggles[76]B=HeroRotationCharDB.Toggles[77]C=HeroRotationCharDB.Toggles[78]D=HeroRotationCharDB.Toggles[79]G=false end;local function aF()EclipseInAny=g:BuffUp(N.EclipseSolar)or g:BuffUp(N.EclipseLunar)EclipseInBoth=g:BuffUp(N.EclipseSolar)and g:BuffUp(N.EclipseLunar)EclipseInLunar=g:BuffUp(N.EclipseLunar)and g:BuffDown(N.EclipseSolar)EclipseInSolar=g:BuffUp(N.EclipseSolar)and g:BuffDown(N.EclipseLunar)EclipseLunarNext=not EclipseInAny and(N.Starfire:Count()==0 and N.Wrath:Count()>0 or g:IsCasting(N.Wrath))or EclipseInSolar;EclipseSolarNext=not EclipseInAny and(N.Wrath:Count()==0 and N.Starfire:Count()>0 or g:IsCasting(N.Starfire))or EclipseInLunar;EclipseAnyNext=not EclipseInAny and N.Wrath:Count()>0 and N.Starfire:Count()>0 end;local function aG()local aH=F(1.5*N.AstralInfluence:TalentRank())_=5+aH;a0=8+aH;J=g:GetEnemiesInMeleeRange(a0)if n()then a4=g:GetEnemiesInMeleeRange(8)K=#J;a5=#a4;a3=g:GetEnemiesInMeleeRange(5)Enemies40y=g:GetEnemiesInRange(40)else K=1;a4=g:GetEnemiesInMeleeRange(8)if#a4>=1 then a5=1 else a5=0 end;a3=g:GetEnemiesInMeleeRange(5)end;TopTrinketID=GetInventoryItemID("player",13)BotTrinketID=GetInventoryItemID("player",14)if not M.Commons.Enabled.TopTrinket and not M.Commons.Enabled.BotTrinket then P={TopTrinketID,BotTrinketID}elseif not M.Commons.Enabled.TopTrinket then P={TopTrinketID}elseif not M.Commons.Enabled.BotTrinket then P={BotTrinketID}end;T=g:ActiveMitigationNeeded()U=g:IsTankingAoE(8)or g:IsTanking(i)UnitsCastinNetherStormCount=ae(a4)UnitsCastinNetherStormCount2=aj(a4)UnitsCastinNetherStormCount3=al(a4)MTNegligableMeleeCount=an(a4)if n()then if MTNegligableMeleeCount>0 then a5=a5-MTNegligableMeleeCount end end;V=true;if not M.Guardian.UseRageDefensively then V=true end;if not BotOn then W=0;X=0 end;if W>0 then W=0 end;if X>0 then X=0 end;ShouldReturn=aE()if m.QueuedCast()then X=m.QueuedCast()return"Custom Queue "..j(X):ID()end;aF()if m.GUISettings.General.OpenerReset>0 and not HeroRotationCharDB.Toggles[6]then starttime=GetTime()endtime=starttime+m.GUISettings.General.OpenerReset elseif m.GUISettings.General.OpenerReset>0 and endtime~=nil and GetTime()>endtime and HeroRotationCharDB.Toggles[6]then HeroRotationCharDB.Toggles[6]=not HeroRotationCharDB.Toggles[6]m.ToggleIconFrame:UpdateButtonText(6)m.Print("Opener is now "..(HeroRotationCharDB.Toggles[6]and"|cff00ff00enabled|r."or"|cffff0000disabled|r."))end;if x and N.UrsolsVortex:IsUsableP()and N.RestorationAffinity:IsAvailable()and N.UrsolsVortex:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if m.Cast(N.UrsolsVortex,nil,nil,nil)then X=102793;return"UrsolsVortex Queue"end elseif(not N.UrsolsVortex:IsUsableP()or N.UrsolsVortex:CooldownRemains()>0 or not g:AffectingCombat()or not N.RestorationAffinity:IsAvailable())and x then HeroRotationCharDB.Toggles[73]=not HeroRotationCharDB.Toggles[73]m.Print("Ursols Vortex Queue is now "..(HeroRotationCharDB.Toggles[73]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if y and N.Typhoon:IsUsableP()and N.BalanceAffinity:IsAvailable()and N.Typhoon:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if m.Cast(N.Typhoon,nil,nil,nil)then X=132469;return"Typhoon Queue"end elseif(not N.Typhoon:IsUsableP()or N.Typhoon:CooldownRemains()>0 or not g:AffectingCombat()or not N.BalanceAffinity:IsAvailable())and y then HeroRotationCharDB.Toggles[74]=not HeroRotationCharDB.Toggles[74]m.Print("Typhoon Queue is now "..(HeroRotationCharDB.Toggles[74]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if z and N.StampedingRoar:IsUsableP()and N.StampedingRoar:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if m.Cast(N.StampedingRoar,nil,nil,nil)then X=106898;return"StampedingRoar Queue"end elseif(not N.StampedingRoar:IsUsableP()or N.StampedingRoar:CooldownRemains()>0 or not g:AffectingCombat())and z then HeroRotationCharDB.Toggles[75]=not HeroRotationCharDB.Toggles[75]m.Print("Stampeding Roar Queue is now "..(HeroRotationCharDB.Toggles[75]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if A and N.IncapacitatingRoar:IsUsableP()and N.IncapacitatingRoar:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if m.Cast(N.IncapacitatingRoar,nil,nil,nil)then X=99;return"IncapacitatingRoar Queue"end elseif(not N.IncapacitatingRoar:IsUsableP()or N.IncapacitatingRoar:CooldownRemains()>0 or not g:AffectingCombat())and A then HeroRotationCharDB.Toggles[76]=not HeroRotationCharDB.Toggles[76]m.Print("Incapacitating Roar Queue is now "..(HeroRotationCharDB.Toggles[76]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if B and N.MightyBash:IsAvailable()and N.MightyBash:IsUsableP()and N.MightyBash:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()then if m.Cast(N.MightyBash,nil,nil,nil)then X=5211;return"MightyBash Queue"end elseif(not N.MightyBash:IsUsableP()or N.MightyBash:CooldownRemains()>0 or not g:AffectingCombat()or not N.MightyBash:IsAvailable())and B then HeroRotationCharDB.Toggles[77]=not HeroRotationCharDB.Toggles[77]m.Print("Mighty Bash Queue is now "..(HeroRotationCharDB.Toggles[77]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if D and N.EntanglingRoots:IsUsableP()and N.EntanglingRoots:CooldownRemains(BypassRecovery)<=0 and g:AffectingCombat()and not g:PrevGCD(1,N.EntanglingRoots)and not g:IsCasting()then if m.Cast(N.EntanglingRoots,nil,nil,nil)then if f("mouseover"):GUID()~=nil and f("mouseover"):IsSpellInRange(N.EntanglingRoots)then W=1339;return"Entangling Roots Queue"end end elseif(not N.EntanglingRoots:IsUsableP()or N.EntanglingRoots:CooldownRemains()>0 or not g:AffectingCombat()or g:PrevGCD(1,N.EntanglingRoots)or g:IsCasting(N.EntanglingRoots)and g:CastRemains()<=0.5)and D then HeroRotationCharDB.Toggles[79]=not HeroRotationCharDB.Toggles[79]m.Print("Entangling Roots Queue Queue is now "..(HeroRotationCharDB.Toggles[79]and"|cff00ff00on|r."or"|cffff0000off|r."))end;if g:IsChanneling(j(323764))then if p(N.Pool)then X=999999;return"channeling"end;return false end;if g:BuffUp(N.TravelForm)and IsFlyableArea()then return false end;if C then if g:BuffUp(N.TravelForm)and N.WildCharge:IsAvailable()and N.WildCharge:CooldownRemains()<=0 and not g:BuffUp(N.Sprint)and not IsFlyableArea()then if p(N.WildCharge,nil)then X=102417;return"Zoom Zoom Jump"end end;if not g:BuffUp(N.TravelForm)and(N.WildCharge:IsAvailable()and N.TravelForm:CooldownRemains()<=0 and not g:BuffUp(N.Sprint)and g:BuffDown(N.SoulShape)and not IsFlyableArea()and not IsIndoors()or IsFlyableArea()and not IsIndoors())then if p(N.TravelForm,nil)then X=783;return"Travel Form for Jump"end end;if N.StampedingRoar:CooldownRemains()<=0 and g:BuffDown(N.SoulShape)and IsIndoors()and g:BuffDown(N.TravelForm)then if p(N.StampedingRoar,nil)then X=106898;return"StampedingRoar"end end;if N.Flicker:IsCastable()and g:BuffUp(N.SoulShape)then if p(N.Flicker,nil)then X=324701;return"Flicker"end end;if N.SoulShape:IsAvailable()and N.SoulShape:IsCastable()and not g:BuffUp(N.SoulShape)and not g:BuffUp(N.StampedingRoar)and not g:BuffUp(N.Sprint)then if p(N.SoulShape,nil)then X=310143;return"zoom zoom soulshape"end end;if N.Sprint:IsAvailable()and N.Sprint:IsCastable()and not g:BuffUp(N.SoulShape)and IsIndoors()and not g:BuffUp(N.StampedingRoar)then if p(N.Sprint,nil)then X=1850;return"Zoom zoom Sprint"end end;if N.CatForm:IsCastable()and not g:BuffUp(N.CatForm)and not g:BuffUp(N.SoulShape)and IsIndoors()then if p(N.CatForm,nil)then X=768;return"Zoom zoom CatForm"end end end;if L.TargetIsValid()then if select(8,GetInstanceInfo())==1698 then if UnitsCastinNetherStormCount>0 and j(99):IsReady()then if p(j(99),nil)then X=99;return"Shout Interrupt MT 1"end end;if UnitsCastinNetherStormCount2>0 and j(99):IsReady()and g:BuffUp(N.BearForm)then if p(N.Pool,nil)then X=99999;return"Pool for Shout Interrupt MT 1"end end;if UnitsCastinNetherStormCount3>0 and N.Barkskin:IsReady()and f("boss1"):NPCID()==117933 and f("boss1"):TimeToDie()>60 then if p(N.Barkskin,nil,nil)then X=22812;return"barkskin defensive MT 6"end end;if i:IsInRange(28)and not i:IsInRange(8)and N.WildCharge:IsReady()and g:BuffUp(N.BearForm)and f("target"):NPCID()~=117933 and f("target"):NPCID()~=118032 then if p(j(102401),nil)then X=102401;return"Wild Charge Back"end end;if true then local ShouldReturn=aw()if ShouldReturn then return ShouldReturn end end;if(select(8,UnitChannelInfo("target"))==234676 or select(9,UnitCastingInfo("target"))==234676)and f("target"):IsInRange(20)then if g:BuffUp(N.BearForm)or g:BuffUp(N.CatForm)then if p(j(106839),nil)then X=11106839;return"interrupt boss MT"end else if p(N.BearForm,nil)then X=5487;return"Bear for interrupt"end end end;if f("boss1"):NPCID()==117933 then if(select(8,UnitChannelInfo("boss1"))==234423 or select(9,UnitCastingInfo("boss1"))==234423)and f("boss1"):IsInRange(20)then if g:BuffUp(N.MoonkinForm)and j(132469):CooldownRemains()<=0 and UnitsCastinNetherStormCount2==0 and UnitsCastinNetherStormCount==0 then if p(j(132469),nil)then X=132469;return"typhoon interrupt boss MT"end elseif g:BuffUp(N.BearForm)or g:BuffUp(N.CatForm)then if p(j(106839),nil)then X=11106839;return"interrupt boss MT"end elseif(not g:BuffUp(N.BearForm)or g:BuffUp(N.CatForm))and j(132469):CooldownRemains()>=0 then if p(N.BearForm,nil)then X=5487;return"Bear for interrupt"end end end;if N.Moonfire:IsReady()then if L.CastCycle(N.Moonfire,g:GetEnemiesInMeleeRange(40),as,not i:IsSpellInRange(N.Moonfire))then return"moonfire MT 4"end end;if a5==0 then if g:BuffUp(N.MoonkinForm)then if(g:HealthPercentage()<M.Guardian2.MTRegrowth-20 and not g:IsCasting(j(8936))or g:HealthPercentage()<M.Guardian2.MTRegrowth-20)and j(8936):IsReady()and not g:IsMoving()then if p(j(8936),nil)then X=8936;return"Regrowth phase 1"end elseif true then local ShouldReturn=aD()if ShouldReturn then return ShouldReturn end end else if p(N.MoonkinForm,nil)then X=197625;return"Moonkin phase 1"end end else if UnitsCastinNetherStormCount>0 and j(99):IsCastable()and g:BuffUp(N.BearForm)then if p(j(99),nil)then X=99;return"Shout Interrupt MT 1"end elseif g:BuffUp(N.BearForm)then local ShouldReturn=aB()if ShouldReturn then return ShouldReturn end elseif g:BuffDown(N.BearForm)then if p(N.BearForm,nil)then X=5487;return"Bear for melee"end end end end;if f("boss1"):NPCID()==117198 then if(select(8,UnitChannelInfo("boss1"))==234676 or select(9,UnitCastingInfo("boss1"))==234676)and f("boss1"):IsInRange(20)then if(g:BuffUp(N.BearForm)or g:BuffUp(N.CatForm))and j(106839):CooldownRemains()<=0 then if p(j(106839),nil)then X=11106839;return"interrupt boss MT"end elseif g:BuffUp(N.BearForm)and j(132469):CooldownRemains()<=0 then if p(j(132469),nil)then X=132469;return"interrupt boss MT"end elseif not g:BuffUp(N.BearForm)then if p(N.BearForm,nil)then X=5487;return"Bear for interrupt"end end end;if(select(8,UnitChannelInfo("boss1"))==236572 or select(9,UnitCastingInfo("boss1"))==236572)and f("boss1"):IsInRange(8)and j(5211):IsAvailable()and j(5211):IsReady()then if p(j(5211),nil)then X=g:DebuffStack(j(236572))return"interrupt boss bash MT"end end;if(select(8,UnitChannelInfo("boss1"))==236572 or select(9,UnitCastingInfo("boss1"))==236572)and g:BuffUp(N.BearForm)then for aI=1,40 do local aJ,aJ,aK,aJ,aJ,aJ,aJ,aJ,aJ,aL,aJ,aJ,aJ,aJ,aJ,aJ=UnitDebuff("player",aI)if aL~=nil and aL==236572 and aK~=nil and aK>=2 and N.SurvivalInstincts:IsCastable()then if p(N.SurvivalInstincts,nil,nil)then X=61336;return"survival_instincts defensive 8"end end;if aL~=nil and aL==236572 and aK~=nil and aK>=1 and N.Barkskin:IsCastable()then if p(N.Barkskin,nil,nil)then X=22812;return"barkskin defensive 6"end end;if aL~=nil and aL==236572 and aK~=nil and aK>=0 and N.Ironfur:IsCastable()and(g:Rage()>=N.Ironfur:Cost()+1 and(g:BuffDown(N.IronfurBuff)or g:BuffStack(N.IronfurBuff)<2 and g:BuffRefreshable(N.Ironfur)or g:Rage()>=90))then if p(N.Ironfur,nil,nil)then X=192081;return"ironfur defensive 4"end end end end;if N.Moonfire:IsReady()then if L.CastCycle(N.Moonfire,g:GetEnemiesInMeleeRange(40),as,not i:IsSpellInRange(N.Moonfire))then return"moonfire MT 4"end end;if a5>=0 then if UnitsCastinNetherStormCount>0 and j(99):IsCastable()and g:BuffUp(N.BearForm)then if p(j(99),nil)then X=99;return"Shout Interrupt MT 1"end elseif g:BuffUp(N.BearForm)then local ShouldReturn=aB()if ShouldReturn then return ShouldReturn end elseif g:BuffDown(N.BearForm)then if p(N.BearForm,nil)then X=5487;return"Bear for melee"end end end end end;if not g:AffectingCombat()and r then local ShouldReturn=ay()if ShouldReturn then return ShouldReturn end end;if not UnitIsEnemy("player","mouseover")and UnitIsDead("mouseover")then if N.Rebirth:IsCastable()and(g:Rage()>=30 and g:BuffUp(N.BearForm)or g:BuffDown(N.BearForm)and not g:IsMoving())then if p(N.Rebirth,nil)then X=20484;return"Rebirth MO"end elseif N.Rebirth:CooldownRemains(BypassRecovery)<=0 and(g:Rage()<30 and g:BuffUp(N.BearForm))then G=true end end;if UnitExists("mouseover")and string.find(UnitGUID("mouseover"),120651)then if N.Moonfire:IsCastable()then if p(N.Moonfire,nil)then W=18921;return"explosive MO SWD"end end end;if UnitExists("target")and string.find(UnitGUID("target"),120651)then if N.Moonfire:IsCastable()then if p(N.Moonfire,nil)then X=8921;return"explosive  SWD"end end end;local aM=UnitThreatSituation("player","target")H={324736,228318,178658,333227,334800,334967,324737,326450,334470,320703,320012,324085,333241,331510,344739,368477,368396,355057,356133,342139,353706,355782,327155,359668,158337}if UnitExists("target")and N.Soothe:IsCastable()then if UnitCanAttack("player","target")and UnitAffectingCombat("target")and UnitIsDead("target")~=true then for aI=0,40 do local aJ,aJ,aN,aO,aJ,aJ,aJ,aJ,aJ,aP=UnitBuff("target",aI)for aJ,aQ in pairs(H)do if aQ==aP then if p(N.Soothe,nil)then X=2908;return"Southe Enrage"end end end end end end;if UnitExists("mouseover")and N.Soothe:IsCastable()then if UnitCanAttack("player","mouseover")and UnitAffectingCombat("mouseover")and UnitIsDead("mouseover")~=true then for aI=0,40 do local aJ,aJ,aN,aO,aJ,aJ,aJ,aJ,aJ,aP=UnitBuff("mouseover",aI)for aJ,aQ in pairs(H)do if aQ==aP then if p(N.Soothe,nil)then W=12908;return"Southe Enrage mouseover"end end end end end end;if true then local ShouldReturn=aw()if ShouldReturn then return ShouldReturn end end;if O.Jotungeirr:IsEquippedAndReady()and aa~=2 and o()then if p(O.Jotungeirr,nil,nil)then X=16;return"jotungeirr_destinys_call main"end end;if aa~=2 and o()then local ax=g:GetUseableTrinkets(P)if ax then if p(ax,nil,nil)then if ax:ID()==TopTrinketID and M.Commons.Enabled.TopTrinket and(M.Commons.TopTrinketHP<=0 and o()or M.Commons.TopTrinketHP>g:HealthPercentage())then X=24;return"top trinket 1"elseif ax:ID()==BotTrinketID and M.Commons.Enabled.BotTrinket and(M.Commons.BotTrinketHP<=0 and o()or M.Commons.BotTrinketHP>g:HealthPercentage())then X=30;return"bot trinket 1"end end end end;if M.Commons.Enabled.Potions and s and O.PotionofPhantomFire:IsReady()and(aa~=2 and(g:BuffUp(N.BerserkBuff)or g:BuffUp(N.Incarnation))and g:BuffRemains(N.IncarnationBuff)<=26 and not m.GUISettings.General.HoldPotforBL or m.GUISettings.General.HoldPotforBL and g:BloodlustUp())then if p(O.PotionofPhantomFire,nil,nil)then X=50;return"potion main"end end;if true then local ShouldReturn=aB()if ShouldReturn then return ShouldReturn end end;if true then if m.CastAnnotated(N.Pool,false,"WAIT")then return"Wait/Pool Resources"end end end end;local function aR()if HeroRotationCharDB.Toggles[5]then HeroRotationCharDB.Toggles[5]=not HeroRotationCharDB.Toggles[5]m.ToggleIconFrame:UpdateButtonText(5)end end;function ReturnSpell()if X==0 then return 0 else return X end end;function ReturnSpellMO()if W==0 then return 0 else return W end end;m.SetAPL(104,aG,aR)