local a,b=...local c,d=HeroCache,b.Utils;local e=b.Unit;local f,g,h=e.Player,e.Pet,e.Target;local i,j=e.Focus,e.MouseOver;local k,l,m=e.Arena,e.Boss,e.Nameplate;local n,o=e.Party,e.Raid;local p=b.Spell;local q=b.Item;local UnitAura=UnitAura;local r=C_UnitAuras.GetPlayerAuraBySpellID;local GetTime=GetTime;do local s,t,u;local v,w,x,y,z;function e:AuraInfo(A,B,C)s=self:GUID()if not s then return end;t=A:ID()if s==f:GUID()then if C then return r(t)else local D=r(t)if type(D)~="table"then return nil end;w=D.duration;x=D.expirationTime;v=D.applications;return v,w,x end end;u=self:ID()z=1;while true do _,_,v,_,w,x,_,_,_,y=UnitAura(u,z,B)if not y then return end;if y==t then if C then return UnitAura(u,z,B)else return v,w,x,z end end;z=z+1 end end end;function e:BuffInfo(A,E,C)local B=E and"HELPFUL"or"HELPFUL|PLAYER"return self:AuraInfo(A,B,C)end;function e:BuffStack(A,E,F)if not F and self:BuffDown(A,E,F)then return 0 end;local G=self:BuffInfo(A,E)return G or 0 end;function e:BuffDuration(A,E)local _,H=self:BuffInfo(A,E)return H or 0 end;function e:BuffRemains(A,E,F)local _,_,I=self:BuffInfo(A,E)if not I then return 0 end;if I==0 then return 9999 end;local t=A:ID()if t==115192 or t==256735 then I=I-0.3 end;local J=I-GetTime()-b.RecoveryOffset(F)return J>=0 and J or 0 end;function e:BuffUp(A,E,F)return self:BuffRemains(A,E,F)>0 end;function e:BuffDown(A,E,F)return not self:BuffUp(A,E,F)end;function e:BuffRefreshable(A,E,F)local K=A:PandemicThreshold()return self:BuffRemains(A,E,F)<=K end;function e:BuffTicksRemain(A,E,F)local J=self:BuffRemains(A,E,F)if J==0 then return 0 end;return math.ceil(J/A:TickTime())end;function e:DebuffInfo(A,E,C)local B=E and"HARMFUL"or"HARMFUL|PLAYER"return self:AuraInfo(A,B,C)end;function e:DebuffStack(A,E,F)if not F and self:DebuffDown(A,E,F)then return 0 end;local G=self:DebuffInfo(A,E)return G or 0 end;function e:DebuffDuration(A,E)local _,H=self:DebuffInfo(A,E)return H or 0 end;function e:DebuffRemains(A,E,F)local _,_,I=self:DebuffInfo(A,E)if not I then return 0 end;if I==0 then return 9999 end;local J=I-GetTime()-b.RecoveryOffset(F)return J>=0 and J or 0 end;function e:DebuffUp(A,E,F)return self:DebuffRemains(A,E,F)>0 end;function e:DebuffDown(A,E,F)return not self:DebuffUp(A,E,F)end;function e:DebuffRefreshable(A,K,E,F)local K=K or A:PandemicThreshold()return self:DebuffRemains(A,E,F)<=K end;function e:DebuffTicksRemain(A,E,F)local J=self:DebuffRemains(A,E,F)if J==0 then return 0 end;return math.ceil(J/A:TickTime())end;do local L={p(2825),p(32182),p(80353),p(90355),p(160452),p(264667),p(35475),p(35476),p(146555),p(178207),p(230935),p(256740),p(309658)}function e:BloodlustRemains(F)local s=self:GUID()if not s then return false end;for M=1,#L do local N=L[M]if self:BuffUp(N,nil)then return self:BuffRemains(N,nil,F)end end;return 0 end;function e:BloodlustUp(F)return self:BloodlustRemains(F)>0 end;function e:BloodlustDown(F)return not self:BloodlustUp(F)end end;do local O={p(10060)}function e:PowerInfusionRemains(F)local s=self:GUID()if not s then return false end;for M=1,#O do local P=O[M]if self:BuffUp(P,nil)then return self:BuffRemains(P,nil,F)end end;return 0 end;function e:PowerInfusionUp(F)return self:PowerInfusionRemains(F)>0 end;function e:PowerInfusionDown(F)return not self:PowerInfusionUp(F)end end;do local Q={p(57724),p(57723),p(80354),p(264689)}function e:BloodlustExhaustRemains(F)local s=self:GUID()if not s then return false end;for M=1,#Q do local R=Q[M]if self:DebuffUp(R,nil)then return self:DebuffRemains(R,nil,F)end end;return 0 end;function e:BloodlustExhaustUp(F)return self:BloodlustExhaustRemains(F)>0 end;function e:BloodlustExhaustDown(F)return not self:BloodlustExhaustUp(F)end end;do local S={p(382530),p(388691),p(397383)}function e:EnemyAbsorb()for M=1,#S do local T=S[M]if self:BuffUp(T,true)then return true end end;return false end end